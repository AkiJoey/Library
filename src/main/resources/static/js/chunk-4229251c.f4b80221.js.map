{"version":3,"sources":["webpack:///./src/main/webapp/utils/validate.js","webpack:///./src/main/webapp/views/user/info/index.vue?f726","webpack:///./src/main/webapp/views/user/info/index.vue?9973","webpack:///src/main/webapp/views/user/info/index.vue","webpack:///./src/main/webapp/views/user/info/index.vue?32ac","webpack:///./src/main/webapp/views/user/info/index.vue"],"names":["validateUsername","rule","value","callback","Error","validatePassword","length","validateOldPassword","this","form","checkPassword","$refs","validateField","validateCheckPassword","oldPassword","vaildateNewPassword","validatePhone","test","validateAddress","render","_vm","_h","$createElement","_c","_self","ref","attrs","rules","avatar","beforeUpdate","httpRequest","on","handleSelect","slot","_v","handleUpload","model","$$v","$set","expression","handleSubmit","handleLogout","staticRenderFns","component"],"mappings":"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","file":"js/chunk-4229251c.f4b80221.js","sourcesContent":["// validate utils\r\n\r\nexport const validateUsername = (rule, value, callback) => {\r\n  if (value === '') {\r\n    callback(new Error('请输入用户名'))\r\n  } else {\r\n    callback()\r\n  }\r\n}\r\n\r\nexport const validatePassword = (rule, value, callback) => {\r\n  if (value === '') {\r\n    callback(new Error('请输入密码'))\r\n  } else if (value.length < 6) {\r\n    callback(new Error('密码长度不能小于 6 位'))\r\n  } else {\r\n    callback()\r\n  }\r\n}\r\n\r\nexport const validateOldPassword = function (rule, value, callback) {\r\n  if (value === '') {\r\n    callback(new Error('请输入密码'))\r\n  } else if (value.length < 6) {\r\n    callback(new Error('密码长度不能小于 6 位'))\r\n  } else {\r\n    if (this.form.checkPassword !== '') {\r\n      this.$refs.form.validateField('checkPassword')\r\n    }\r\n    callback()\r\n  }\r\n}\r\n\r\nexport const validateCheckPassword = function (rule, value, callback) {\r\n  if (value === '') {\r\n    callback(new Error('请再次输入密码'))\r\n  } else if (value !== this.form.oldPassword) {\r\n    callback(new Error('两次输入密码不一致'))\r\n  } else {\r\n    callback()\r\n  }\r\n}\r\n\r\nexport const vaildateNewPassword = (rule, value, callback) => {\r\n  if (value === '') {\r\n    callback(new Error('请输入新密码'))\r\n  } else if (value.length < 6) {\r\n    callback(new Error('密码长度不能小于 6 位'))\r\n  } else {\r\n    callback()\r\n  }\r\n}\r\n\r\nexport const validatePhone = (rule, value, callback) => {\r\n  if (value === '') {\r\n    callback(new Error('请输入手机号'))\r\n  } else if (!/^[1][3,4,5,7,8,9][0-9]{9}$/.test(value)) {\r\n    callback(new Error('手机号格式不正确'))\r\n  } else {\r\n    callback()\r\n  }\r\n}\r\n\r\nexport const validateAddress = (rule, value, callback) => {\r\n  if (value === '') {\r\n    callback(new Error('请输入地址'))\r\n  } else {\r\n    callback()\r\n  }\r\n}\r\n","import mod from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=8fdd26ee&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=8fdd26ee&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"status-icon\":\"\",\"label-width\":\"70px\"}},[_c('el-form-item',[_c('img',{attrs:{\"src\":_vm.avatar}}),_c('el-upload',{ref:\"upload\",attrs:{\"action\":\"#\",\"limit\":1,\"auto-upload\":false,\"before-upload\":_vm.beforeUpdate,\"http-request\":_vm.httpRequest}},[_c('el-button',{attrs:{\"slot\":\"trigger\",\"icon\":\"el-icon-refresh\"},on:{\"click\":_vm.handleSelect},slot:\"trigger\"},[_vm._v(\"选择图片\")]),_c('el-button',{attrs:{\"icon\":\"el-icon-check\",\"type\":\"primary\"},on:{\"click\":_vm.handleUpload}},[_vm._v(\"点击上传\")]),_c('p',{attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\"只能上传 jpg / png 文件, 且不超过 500kb\")])],1)],1),_c('el-form-item',{attrs:{\"label\":\"用户名\",\"prop\":\"username\"}},[_c('el-input',{model:{value:(_vm.form.username),callback:function ($$v) {_vm.$set(_vm.form, \"username\", $$v)},expression:\"form.username\"}})],1),_c('el-form-item',{attrs:{\"label\":\"手机号\",\"prop\":\"phone\"}},[_c('el-input',{model:{value:(_vm.form.phone),callback:function ($$v) {_vm.$set(_vm.form, \"phone\", $$v)},expression:\"form.phone\"}})],1),_c('el-form-item',{attrs:{\"label\":\"地址\",\"prop\":\"address\"}},[_c('el-input',{model:{value:(_vm.form.address),callback:function ($$v) {_vm.$set(_vm.form, \"address\", $$v)},expression:\"form.address\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"icon\":\"el-icon-check\",\"type\":\"primary\"},on:{\"click\":_vm.handleSubmit}},[_vm._v(\"提交\")]),_c('el-button',{attrs:{\"icon\":\"el-icon-switch-button\"},on:{\"click\":_vm.handleLogout}},[_vm._v(\"退出\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <el-form :model=\"form\" :rules=\"rules\" ref=\"form\" status-icon label-width=\"70px\">\r\n    <el-form-item>\r\n      <img :src=\"avatar\">\r\n      <el-upload ref=\"upload\" action=\"#\" :limit=\"1\" :auto-upload=\"false\" :before-upload=\"beforeUpdate\" :http-request=\"httpRequest\">\r\n        <el-button icon=\"el-icon-refresh\" slot=\"trigger\" @click=\"handleSelect\">选择图片</el-button>\r\n        <el-button icon=\"el-icon-check\" type=\"primary\" @click=\"handleUpload\">点击上传</el-button>\r\n        <p slot=\"tip\">只能上传 jpg / png 文件, 且不超过 500kb</p>\r\n      </el-upload>\r\n    </el-form-item>\r\n    <el-form-item label=\"用户名\" prop=\"username\">\r\n      <el-input v-model=\"form.username\" />\r\n    </el-form-item>\r\n    <el-form-item label=\"手机号\" prop=\"phone\">\r\n      <el-input v-model=\"form.phone\" />\r\n    </el-form-item>\r\n    <el-form-item label=\"地址\" prop=\"address\">\r\n      <el-input v-model=\"form.address\" />\r\n    </el-form-item>\r\n    <el-form-item>\r\n      <el-button icon=\"el-icon-check\" type=\"primary\" @click=\"handleSubmit\">提交</el-button>\r\n      <el-button icon=\"el-icon-switch-button\" @click=\"handleLogout\">退出</el-button>\r\n    </el-form-item>\r\n  </el-form>\r\n</template>\r\n\r\n<script>\r\n  import { getMajor, replace, report } from '@/api/user'\r\n  import {\r\n    validateUsername,\r\n    validatePhone,\r\n    validateAddress\r\n  } from '@/utils/validate'\r\n  export default {\r\n    name: 'Info',\r\n    data() {\r\n      return {\r\n        avatar: this.$store.getters.avatar,\r\n        form: {\r\n          username: this.$store.getters.name,\r\n          phone: '',\r\n          address: ''\r\n        },\r\n        rules: {\r\n          username: [{\r\n            validator: validateUsername,\r\n            trigger: 'blur'\r\n          }],\r\n          phone: [{\r\n            validator: validatePhone,\r\n            trigger: 'blur'\r\n          }],\r\n          address: [{\r\n            validator: validateAddress,\r\n            trigger: 'blur'\r\n          }]\r\n        }\r\n      }\r\n    },\r\n    created() {\r\n      getMajor().then(response => {\r\n        const { data } = response\r\n        this.form = data.major\r\n      })\r\n    },\r\n    methods: {\r\n      beforeUpdate(file) {\r\n        if (file.type !== 'image/jpeg' && file.type !== 'image/png') {\r\n          this.$message.error('上传头像图片只能是 JPG 或 PNG 格式')\r\n          return false\r\n        } else if (file.size > 1024 * 1024) {\r\n          this.$message.error('上传头像图片大小不能超过 1MB')\r\n          return false\r\n        }\r\n        return true\r\n      },\r\n      httpRequest({ file }) {\r\n        const data = new FormData()\r\n        data.append('avatar', file)\r\n        replace(data).then(response => {\r\n          const { message, data } = response\r\n          this.avatar = data.avatar\r\n          this.$store.commit('user/setAvatar', this.avatar)\r\n          this.$message.success(message)\r\n        }).catch(() => this.$refs.upload.clearFiles())\r\n      },\r\n      handleSelect() {\r\n        this.$refs.upload.clearFiles()\r\n      },\r\n      handleUpload() {\r\n        if (this.$refs.upload.uploadFiles.length > 0) {\r\n          this.$refs.upload.submit()\r\n        } else {\r\n          this.$message.error('请选择图片')\r\n        }\r\n      },\r\n      handleSubmit() {\r\n        this.$refs.form.validate(valid => {\r\n          if (valid) {\r\n            report(this.form).then(response => {\r\n              const { message } = response\r\n              this.$store.commit('user/setName', this.form.username)\r\n              this.$message.success(message)\r\n            })\r\n          } else {\r\n            this.$message.error('Format Error')\r\n            return false\r\n          }\r\n        })\r\n      },\r\n      handleLogout() {\r\n        this.$store.dispatch('user/logout').then(response => {\r\n          const { message } = response\r\n          this.$message.success(message)\r\n          this.$router.push({ path: '/' })\r\n        })\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .el-form {\r\n    @for $i from 1 to 6 {\r\n      & > div:nth-child(#{$i}) {\r\n        width: 425px;\r\n        animation: star (.5s + $i * .1);\r\n        &:first-child {\r\n          width: 500px;\r\n          margin-bottom: 30px;\r\n          & > div > div {\r\n            margin-left: 30px;\r\n            float: left;\r\n          }\r\n          img {\r\n            width: 125px;\r\n            height: 125px;\r\n            margin-left: -55px;\r\n            border-radius: 5px;\r\n            float: left;\r\n          }\r\n          p {\r\n            margin: 9px 5px;\r\n            font-size: 10px;\r\n          }\r\n        }\r\n        button {\r\n          margin: 0 20px 0 0;\r\n        }\r\n      }\r\n    }\r\n  }\r\n</style>","import mod from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../../../node_modules/thread-loader/dist/cjs.js!../../../../../../node_modules/babel-loader/lib/index.js!../../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=8fdd26ee&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=8fdd26ee&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8fdd26ee\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}